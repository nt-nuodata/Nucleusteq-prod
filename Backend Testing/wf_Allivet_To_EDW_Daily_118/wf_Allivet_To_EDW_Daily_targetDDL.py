# Databricks notebook source
# COMMAND ----------

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.ALLIVET_DAILY_INVOICE_PRE(INVOICE_POSTING_DATE_v2 DATE,
INVOICE_CODE STRING,
TRANSACTION_TYPE STRING,
ALLIVET_ORDER_CODE STRING,
ALLIVET_SKU STRING,
PETSMART_ORDER_CODE STRING,
PETSMART_SKU INT,
UPC BIGINT,
UNITS_SOLD INT,
PRODUCT_COST INT,
RETAIL_PRICE INT,
MANUFACTURER STRING,
BRAND STRING,
TITLE STRING,
FREIGHT_FEE INT,
PACKAGING_FEE INT,
DISPENSING_FEE INT,
SHIPPED_DATE DATE,
FULFILLMENT_ORIGIN_ZIP_CODE STRING,
SHIPPING_CARRIER STRING,
TRACKING_NUMBER STRING,
ALLIVET_CUSTOMER_ID STRING,
PET_NAME STRING,
PET_TYPE STRING,
BREED_TYPE STRING,
PET_GENDER STRING,
PET_DOB DATE,
PET_WEIGHT INT,
PET_ALLERGY STRING,
PET_MEDICAL_CONDITIONS STRING,
PET_IS_PREGNANT INT,
VET_CLINIC_NAME STRING,
VETERINARY_NAME STRING,
VET_ADDRESS STRING,
VET_CITY STRING,
VET_STATE STRING,
VET_ZIP STRING,
VET_PHONE_NUMBER STRING,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.ALLIVET_DAILY_ORDER_PRE(ALLIVET_ORDER_CODE STRING,
ALLIVET_ORDER_LINE_NUMBER INT,
ALLIVET_ORDER_DATE DATE,
PETSMART_ORDER_DATE DATE,
ORDER_STATUS STRING,
PETSMART_ORDER_CODE STRING,
SUB_TOTAL INT,
FREIGHT INT,
TOTAL INT,
SHIPPING_METHOD_CODE STRING,
IS_ORDER_VOIDED INT,
IS_ORDER_ONHOLD INT,
ORDER_CREATED_DATE DATE,
ORDER_MODIFIED_DATE DATE,
SHIPPED_DATE DATE,
IS_ORDER_SHIPPED INT,
INTERNAL_NOTES STRING,
PUBLIC_NOTES STRING,
AUTOSHIP_DISCOUNT_AMOUNT INT,
ORDER_MERCHANT_NOTES STRING,
IS_RISKORDER INT,
RISK_REASONS STRING,
ORIGINAL_SHIPPING_METHOD_CODE STRING,
IS_SHIPHOLD INT,
SHIPHOLD_DATE DATE,
SHIPRELEASED_DATE DATE,
ALLIVET_SKU STRING,
PETSMART_SKU INT,
ORDERED_QUANTITY INT,
ITEM_DESCRIPTION STRING,
EXT_PRICE INT,
ORDER_DETAIL_CREATED_DATE DATE,
ORDER_DETAIL_MODIFIED_DATE DATE,
HOW_TO_GET_RX STRING,
VET_CODE INT,
PET_CODE INT,
IS_ORDER_DETAIL_ONHOLD INT,
IS_ONHOLD_TOFILL INT,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.ALLIVET_INVOICE_DAY(INVOICE_POSTING_DT DATE,
INVOICE_CD STRING,
TXN_TYPE STRING,
ALLIVET_ORDER_NBR STRING,
ALLIVET_SKU_NBR STRING,
PRODUCT_ID INT,
PETSMART_ORDER_NBR STRING,
PETSMART_SKU_NBR INT,
UPC_ID BIGINT,
SOLD_UNITS_QTY INT,
PRODUCT_COST INT,
RETAIL_PRICE INT,
MANUFACTURER STRING,
BRAND_NAME STRING,
TITLE STRING,
FREIGHT_FEE_AMT INT,
PACKAGING_FEE_AMT INT,
DISPENSING_FEE_AMT INT,
SHIPPED_DT DATE,
FULFILLMENT_ORIGIN_ZIP_CD STRING,
SHIP_CARRIER_NAME STRING,
TRACKING_NBR STRING,
ALLIVET_CUSTOMER_NBR STRING,
PET_NAME STRING,
PET_TYPE STRING,
BREED_TYPE STRING,
PET_GENDER STRING,
PET_BIRT_DT DATE,
PET_WEIGHT INT,
PET_ALLERGY_DESC STRING,
PET_MEDICAL_CONDITION STRING,
PET_PREGNANT_FLAG INT,
VET_CLINIC_NAME STRING,
VET_NAME STRING,
VET_ADDRESS STRING,
VET_CITY STRING,
VET_STATE_CD STRING,
VET_ZIP_CD STRING,
VET_PHONE_NBR STRING,
DELETE_FLAG INT,
UPDATE_TSTMP TIMESTAMP,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.ALLIVET_DAILY_SYSTEM_AUDIT_PRE_v2(ALLIVET_ORDER_CODE_v2 STRING,
ALLIVET_ORDER_COUNTER INT,
ALLIVET_ORDER_LINE_NUMBER INT,
OPERATION STRING,
CUSTOMER_CODE STRING,
EXTRA_INFO STRING,
CHANGE_DATE DATE,
FROM_ITEM_CODE STRING,
TO_ITEM_CODE STRING,
PRESCRIPTION_ID BIGINT,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.ALLIVET_SYSTEM_AUDIT_DAY(ALLIVET_ORDER_NBR STRING,
ALLIVET_ORDER_CNTR INT,
ALLIVET_ORDER_LN_NBR INT,
OPERATION STRING,
ALLIVET_CUSTOMER_NBR STRING,
EXTRA_INFO STRING,
ORDER_CHG_DT DATE,
FROM_ITEM_CD STRING,
TO_ITEM_CD STRING,
PRESCRIPTION_ID BIGINT,
UPDATE_TSTMP TIMESTAMP,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.ALLIVET_ORDER_DAY(ALLIVET_ORDER_NBR STRING,
ALLIVET_ORDER_LN_NBR INT,
ALLIVET_ORDER_DT DATE,
PETSMART_ORDER_DT DATE,
ORDER_STATUS STRING,
PRODUCT_ID INT,
PETSMART_ORDER_NBR STRING,
PETSMART_SKU_NBR INT,
ALLIVET_SKU_NBR STRING,
SUB_TOTAL_AMT INT,
FREIGHT_COST INT,
TOTAL_AMT INT,
SHIP_METHOD_CD STRING,
ORDER_VOIDED_FLAG INT,
ORDER_ONHOLD_FLAG INT,
ORDER_CREATED_DT DATE,
ORDER_MODIFIED_DT DATE,
SHIPPED_DT DATE,
ORDER_SHIPPED_FLAG INT,
INTERNAL_NOTES STRING,
PUBLIC_NOTES STRING,
AUTOSHIP_DISCOUNT_AMT INT,
ORDER_MERCHANT_NOTES STRING,
RISKORDER_FLAG INT,
RISK_REASON STRING,
ORIG_SHIP_METHOD_CD STRING,
SHIP_HOLD_FLAG INT,
SHIP_HOLD_DT DATE,
SHIP_RELEASE_DT DATE,
ORDER_QTY INT,
ITEM_DESC STRING,
EXT_PRICE INT,
ORDER_DETAIL_CREATED_DT DATE,
ORDER_DETAIL_MODIFIED_DT DATE,
HOW_TO_GET_RX STRING,
VET_CD INT,
PET_CD INT,
ORDER_DETAIL_ONHOLD_FLAG INT,
ONHOLD_TO_FILL_FLAG INT,
UPDATE_TSTMP TIMESTAMP,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.ALLIVET_ORDER_STATUS_DAY(ALLIVET_ORDER_NBR STRING,
RX_HOLD_DT DATE,
OPEN_DT DATE,
COMPLETE_DT DATE,
VOID_DT DATE,
UPDATE_TSTMP TIMESTAMP,
LOAD_TSTMP TIMESTAMP) USING DELTA;